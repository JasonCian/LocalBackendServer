/**
 * ============================================================================
 * Anonymous Theme - 代码块样式 / Code Block Styles
 * ============================================================================
 * 
 * 文件: Anonymous/Syntax/codeblock.css
 * 描述: 代码块和语法高亮的样式定义
 *       Styles for code blocks and syntax highlighting
 * 
 * Markdown 语法 / Markdown Syntax:
 * ```language
 * // 代码内容
 * ```
 * 
 * 参考: https://support.typora.io/Code-Block-Styles/
 * ============================================================================
 */

/* ============================================================================
 * 代码块容器样式 - Code Block Container Styles
 * ============================================================================ */

/**
 * 代码块基础样式
 */
pre {
  margin-top: var(--anonymous-space-4);
  margin-bottom: 0;
  box-sizing: border-box;
  background: var(--anonymous-bg-secondary) !important;
  border-radius: var(--anonymous-radius-lg);
  font-size: var(--anonymous-text-sm) !important;
  color: var(--anonymous-text-code);
}

/**
 * 嵌套 pre 元素（代码块内容）
 */
pre pre {
  background: transparent !important;
  padding: 5px 10px;
  border: none;
}

/**
 * CodeMirror 编辑器包装
 */
pre .CodeMirror-wrap {
  padding: var(--anonymous-space-4) var(--anonymous-space-4)
    var(--anonymous-space-4) 0;
}

pre .CodeMirror-wrap .CodeMirror-scroll {
  overflow-x: auto;
}

pre .CodeMirror-sizer {
  padding-left: 4px;
}

/**
 * 代码块行号区域
 */
pre .CodeMirror-gutters {
  background: var(--anonymous-bg-secondary);
  border-color: var(--anonymous-border-default);
}

/* ============================================================================
 * 代码块语言提示 - Code Block Language Tooltip
 * ============================================================================ */

/**
 * 代码块语言选择器
 */
.md-fences {
  background-color: var(--anonymous-bg-secondary);
  color: var(--anonymous-text-muted);
}

.md-fences .code-tooltip {
  z-index: 50;
  right: 0 !important;
  bottom: -28px !important;
  padding: 0;
  border-radius: var(--anonymous-radius-md);
  background-color: var(--anonymous-bg-secondary);
  color: var(--anonymous-text-primary);
}

.md-fences .code-tooltip input,
.md-fences .code-tooltip span {
  margin: 0;
  padding: 3px;
  border-radius: var(--anonymous-radius-md);
}

/* ============================================================================
 * CodeMirror 语法高亮主题 - CodeMirror Syntax Highlighting Theme
 * ============================================================================ */

/**
 * 代码块语法高亮基础
 * 使用 .cm-s-inner 类覆盖 Typora 默认主题
 */
.cm-s-inner {
  background-color: transparent !important;
  color: var(--anonymous-text-code);
}

/**
 * 行号区域样式
 */
.cm-s-inner .CodeMirror-gutters {
  border-right-color: var(--anonymous-border-default);
  color: var(--anonymous-text-code);
}

.cm-s-inner .CodeMirror-guttermarker,
.cm-s-inner .CodeMirror-guttermarker-subtle,
.cm-s-inner .CodeMirror-linenumber {
  color: var(--anonymous-text-muted);
}

/**
 * 光标样式
 */
.cm-s-inner .CodeMirror-cursor {
  border-left: 1px solid var(--anonymous-border-default);
}

/**
 * 代码选中样式
 */
.cm-s-inner div.CodeMirror-selected,
.cm-s-inner.CodeMirror-focused div.CodeMirror-selected,
.cm-s-inner .CodeMirror-line::selection,
.cm-s-inner .CodeMirror-line > span::selection,
.cm-s-inner .CodeMirror-line > span > span::selection,
.cm-s-inner .CodeMirror-line::-moz-selection,
.cm-s-inner .CodeMirror-line > span::-moz-selection,
.cm-s-inner .CodeMirror-line > span > span::-moz-selection {
  background: var(--anonymous-accent-alpha-40);
}

/**
 * 当前行背景
 */
.cm-s-inner .CodeMirror-activeline-background {
  background: transparent;
}

/* ============================================================================
 * 语法高亮 Token 颜色 - Syntax Highlighting Token Colors
 * ============================================================================ */

/**
 * 关键字 - Keywords (if, else, for, while, return, etc.)
 */
.cm-s-inner .cm-keyword {
  color: var(--anonymous-syntax-keyword);
}

/**
 * 操作符 - Operators (+, -, *, /, =, ==, etc.)
 */
.cm-s-inner .cm-operator {
  color: var(--anonymous-syntax-operator);
}

/**
 * 变量 - Variables
 */
.cm-s-inner .cm-variable {
  color: var(--anonymous-syntax-variable);
}

.cm-s-inner .cm-variable-2 {
  color: var(--anonymous-syntax-variable-2);
}

.cm-s-inner .cm-variable-3 {
  color: var(--anonymous-syntax-variable-3);
}

/**
 * 内置对象 - Built-in Objects
 */
.cm-s-inner .cm-builtin {
  color: var(--anonymous-syntax-builtin);
}

/**
 * 原子值 - Atoms (true, false, null, undefined, etc.)
 */
.cm-s-inner .cm-atom {
  color: var(--anonymous-syntax-atom);
}

/**
 * 数字 - Numbers
 */
.cm-s-inner .cm-number {
  color: var(--anonymous-syntax-number);
}

/**
 * 定义 - Definitions (function names, class names, etc.)
 */
.cm-s-inner .cm-def {
  color: var(--anonymous-syntax-def);
}

/**
 * 字符串 - Strings
 */
.cm-s-inner .cm-string {
  color: var(--anonymous-syntax-string);
}

.cm-s-inner .cm-string-2 {
  color: var(--anonymous-syntax-string-2);
}

/**
 * 注释和元信息 - Comments and Meta
 */
.cm-s-inner .cm-comment,
.cm-s-inner .cm-meta {
  color: var(--anonymous-syntax-comment);
}

/**
 * 属性 - Attributes
 */
.cm-s-inner .cm-attribute {
  color: var(--anonymous-syntax-attribute);
}

/**
 * 属性值 - Properties
 */
.cm-s-inner .cm-property {
  color: var(--anonymous-syntax-property);
}

/**
 * 限定符 - Qualifiers
 */
.cm-s-inner .cm-qualifier {
  color: var(--anonymous-syntax-qualifier);
}

/**
 * HTML/XML 标签 - Tags
 */
.cm-s-inner .cm-tag {
  color: var(--anonymous-syntax-tag);
}

.cm-s-inner .cm-tag.cm-bracket {
  color: var(--anonymous-syntax-tag-bracket);
}

/**
 * 标题 - Headers
 */
.cm-s-inner .cm-header,
.cm-s-inner.cm-header {
  color: var(--anonymous-syntax-header);
}

/**
 * 括号匹配 - Matching Brackets
 */
.cm-s-inner .CodeMirror-matchingbracket {
  text-decoration: underline;
  color: var(--anonymous-text-code) !important;
}

/* ============================================================================
 * 通用代码提示框 - General Code Tooltip
 * ============================================================================ */

.code-tooltip {
  box-shadow: none;
}

.code-tooltip .ty-input {
  border-color: var(--anonymous-border-default);
}
